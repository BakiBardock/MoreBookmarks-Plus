#Communion & Denominations
catholic_communion_nestorian_decision = {
	picture = "gfx/interface/illustrations/decisions/decision_major_religion.dds"

	desc = catholic_communion_nestorian_decision
	selection_tooltip = catholic_communion_nestorian_decision_tooltip
	major = yes

	ai_check_interval = 120

	is_shown = {
		is_ruler = yes
		is_landed = yes
		faith = faith:nestorian
		NOR = {
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:flag_catholic_communion_nestorian
			}
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:flag_school_edessa
			}
		}
		highest_held_title_tier >= 3
	}

	is_valid = {
		piety_level >= max_piety_level
		completely_controls = title:c_baghdad
		OR = {
			faith.religious_head = {	#And they have to actually like you enough to want to invest you.
				opinion = {
					target = root
					value >= high_positive_opinion
				}
			}
			root = { has_strong_usable_hook = faith.religious_head }	#Or you have a strong hook on them that you can actually use.
			root = { has_weak_hook = faith.religious_head }	#Or a regular hook, to be fair, provided you meet the other criteria.
		}
	}

	is_valid_showing_failures_only = {
		is_capable_adult = yes
		is_imprisoned = no
		is_independent_ruler = yes
	}

	effect = {
		show_as_tooltip = { catholic_communion_nestorian_scripted_effect = yes }
		trigger_event = change_communion.0001
		hidden_effect = {
			add_to_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:flag_catholic_communion_nestorian
			}
		}
	}

	ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 5
		modifier = {
			add = 50
			has_trait = cynical
		}
	}
}

#restore_african_church_decision = {
#	picture = "gfx/interface/illustrations/decisions/decision_major_religion.dds"
#
#	desc = restore_african_church_decision
#	selection_tooltip = restore_african_church_decision_tooltip
#	major = yes
#
#	ai_check_interval = 120
#
#	is_shown = {
#		is_ruler = yes
#		has_title = title:k_papal_state
#		faith = faith:catholic
#		NOT = {
#			is_target_in_global_variable_list = {
#				name = unavailable_unique_decisions
#				target = flag:flag_restore_african_church
#			}
#		}
#	}
#
#	is_valid = {
#		title:d_tunis.holder.faith = root.faith
#	}
#
#	is_valid_showing_failures_only = {
#		is_capable_adult = yes
#		is_imprisoned = no
#		is_independent_ruler = yes
#	}
#
#	effect = {
#		show_as_tooltip = { restore_african_church_scripted_effect = yes }
#		trigger_event = change_communion.0010
#		hidden_effect = {
#			add_to_global_variable_list = {
#				name = unavailable_unique_decisions
#				target = flag:flag_restore_african_church
#			}
#		}
#	}
#
#	ai_potential = {
#		always = yes
#	}
#
#	ai_will_do = {
#		base = 40
#		modifer = {
#			add = 60
#			has_trait = zealous
#		}
#	}
#}
#

new_mend_the_great_schism_decision = {
	picture = "gfx/interface/illustrations/decisions/decision_major_religion.dds"

	desc = mend_the_great_schism_decision_desc
	selection_tooltip = mend_the_great_schism_decision_tooltip
	major = yes

	ai_check_interval = 120

	is_shown = {
		is_ruler = no
		is_landed = yes
		faith.religion = faith:catholic.religion #Christian Only
		NOT = {  #Can only do it once.
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:flag_mended_great_schism
			}
		}
		highest_held_title_tier > 4 #Only Emperors
	}

	is_valid = {
		piety_level >= max_piety_level
		completely_controls = title:c_byzantion
		completely_controls = title:c_antiocheia
		completely_controls = title:c_jerusalem
		completely_controls = title:c_alexandria
		completely_controls = title:c_roma
		custom_description = {
			text = "mend_schism_byzantion_bishop"
			title:c_byzantion.holder.faith = root.faith
		}
		custom_description = {
			text = "mend_schism_antiocheia_bishop"
			title:c_antiocheia.holder.faith = root.faith #Either own County directly, or have a vassal of same religion.
		}
		custom_description = {
			text = "mend_schism_jerusalem_bishop"
			title:c_jerusalem.holder.faith = root.faith #Either own County directly, or have a vassal of same religion.
		}
		custom_description = {
			text = "mend_schism_alexandria_bishop"
			title:c_alexandria.holder.faith = root.faith #Either own County directly, or have a vassal of same religion.
		}
		custom_description = {
			text = "mend_schism_roma_bishop"
			title:c_roma.holder.faith = root.faith #Either own County directly, or have a vassal of same religion.
		}
	}

	is_valid_showing_failures_only = {
		is_capable_adult = yes
		is_imprisoned = no
		is_independent_ruler = yes
	}

	effect = {
		custom_tooltip = mend_the_great_schism_decision_effect_tooltip
		show_as_tooltip = {
			mend_great_schism_scripted_effect = yes
		}
		trigger_event = change_communion.1000
		hidden_effect = {
			add_to_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:flag_mended_great_schism
			}
		}
	}
	
	ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 100
	}
}